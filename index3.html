<!DOCTYPE html>
<html lang="en" data-theme="matrix">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BLACK CODE BROWSER ‚Äî ATOMIC ‚äó TAPE CMS ‚äó MX2DB</title>
  <meta name="theme-color" content="#020409" />
  <link rel="manifest" href="manifest.json" />

  <!-- Atomic CSS is virtual: sw.js serves /atomic.css from manifest.json.atomic.fold -->
  <link rel="stylesheet" href="/atomic.css" />

  <!-- UI CSS (kept here as frame styling; the atomic.css endpoint holds your canonical atomic controls) -->
  <style>
    :root{
      --tab-height:42px; --sidebar-width:280px; --topbar-height:56px;
      --bg-0:#020409; --bg-1:#050912; --bg-2:#071022;
      --panel:rgba(255,255,255,.045); --panel2:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.14); --border-soft:rgba(255,255,255,.09);
      --fg-0:#eafff8; --fg-1:rgba(234,255,248,.78); --fg-2:rgba(234,255,248,.56);
      --accent:#16f2aa; --accent2:#61e7ff; --accent-soft:rgba(22,242,170,.14);
      --hazard:#ffb300; --danger:#ff6b6b; --success:#00d9a6; --warning:#ffb300;
      --s1:4px; --s2:8px; --s3:12px; --s4:16px; --s5:24px; --s6:32px; --s7:48px;
      --r2:8px; --r3:12px;
      --mono: ui-monospace, "Cascadia Code", "SFMono-Regular", Menlo, Consolas, monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      --fs0:11px; --fs1:12px; --fs2:13px; --fs3:14px; --fs4:16px; --fs5:18px;
      --shadow-lg:0 8px 32px rgba(0,0,0,.2);
      --transition:150ms ease;
    }

    [data-theme="steam"]{ --accent:#00adee; --accent2:#0099cc; --bg-0:#1b2838; --bg-1:#2a475e; --bg-2:#171a21; }
    [data-theme="chrome"]{ --accent:#4285f4; --accent2:#34a853; --bg-0:#ffffff; --bg-1:#f8f9fa; --bg-2:#e8eaed; --fg-0:#202124; --fg-1:#5f6368; --border:#dadce0; --border-soft:#e8eaed; }
    [data-theme="dark"]{ --accent:#8b5cf6; --accent2:#6366f1; }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:hidden}
    body{background:var(--bg-0);color:var(--fg-0);font-family:var(--sans);font-size:var(--fs3);line-height:1.5}

    ::-webkit-scrollbar{width:8px;height:8px}
    ::-webkit-scrollbar-track{background:transparent}
    ::-webkit-scrollbar-thumb{background:var(--border-soft);border-radius:4px}
    ::-webkit-scrollbar-thumb:hover{background:var(--border)}

    .browser-container{display:grid;grid-template-rows:var(--topbar-height) 1fr;height:100vh}
    .top-bar{
      background:var(--bg-1);
      border-bottom:1px solid var(--border);
      display:grid;
      grid-template-columns:auto 1fr auto;
      align-items:center;
      padding:0 var(--s3);
      gap:var(--s3);
      backdrop-filter: blur(10px);
      z-index:100;
    }
    .logo{display:flex;align-items:center;gap:var(--s2);font-weight:800;font-size:var(--fs5);color:var(--accent);user-select:none}
    .logo-svg{width:28px;height:28px;display:block}
    .search-container{position:relative;max-width:800px;margin:0 auto;width:100%}
    .search-bar{
      width:100%;
      background:var(--bg-2);
      border:1px solid var(--border);
      border-radius:24px;
      padding:10px 48px 10px 44px;
      color:var(--fg-0);
      font-size:var(--fs3);
      transition:var(--transition);
    }
    .search-bar:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-soft)}
    .search-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:var(--fg-2)}
    .search-actions{position:absolute;right:12px;top:50%;transform:translateY(-50%);display:flex;gap:var(--s1)}
    .btn{
      background:var(--panel);border:1px solid var(--border);color:var(--fg-1);
      padding:6px 12px;border-radius:var(--r2);cursor:pointer;font-size:var(--fs2);
      display:inline-flex;align-items:center;gap:6px;transition:var(--transition);user-select:none;
    }
    .btn:hover{background:var(--panel2);border-color:var(--border-soft);transform:translateY(-1px)}
    .btn-primary{background:var(--accent);border-color:var(--accent);color:var(--bg-0);font-weight:700}
    .btn-primary:hover{background:var(--accent2);border-color:var(--accent2)}
    .btn-icon{padding:6px;width:32px;height:32px;justify-content:center}
    .btn-sm{padding:4px 8px;font-size:var(--fs1)}
    .main-content{display:grid;grid-template-columns:var(--sidebar-width) 1fr;height:calc(100vh - var(--topbar-height))}
    .sidebar{background:var(--bg-1);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden}
    .sidebar-header{padding:var(--s4);border-bottom:1px solid var(--border-soft);font-weight:700;color:var(--fg-1);display:flex;justify-content:space-between;align-items:center}
    .nav-list{flex:1;overflow-y:auto;padding:var(--s2) 0}
    .nav-item{display:flex;align-items:center;gap:var(--s3);padding:var(--s3) var(--s4);color:var(--fg-1);text-decoration:none;transition:var(--transition);border-left:3px solid transparent}
    .nav-item:hover{background:var(--panel);color:var(--fg-0)}
    .nav-item.active{background:var(--panel);color:var(--accent);border-left-color:var(--accent)}
    .content-area{display:flex;flex-direction:column;overflow:hidden}
    .tab-bar{
      background:var(--bg-1);border-bottom:1px solid var(--border);
      display:flex;align-items:center;min-height:var(--tab-height);
      padding:0 var(--s3);gap:var(--s2);overflow-x:auto;flex-shrink:0;
    }
    .tab{
      display:flex;align-items:center;gap:var(--s2);
      padding:8px 16px 8px 12px;background:var(--panel);border:1px solid var(--border);
      border-radius:var(--r2);color:var(--fg-1);font-size:var(--fs2);
      cursor:pointer;transition:var(--transition);min-width:120px;max-width:220px;flex-shrink:0;
    }
    .tab:hover{background:var(--panel2)}
    .tab.active{background:var(--bg-0);border-color:var(--accent);color:var(--accent);border-bottom:2px solid var(--accent)}
    .tab-favicon{width:16px;height:16px;border-radius:2px;background:linear-gradient(135deg,var(--accent),var(--accent2))}
    .tab-close{margin-left:auto;opacity:.55;transition:var(--transition)}
    .tab-close:hover{opacity:1;color:var(--danger)}
    .new-tab{padding:8px;min-width:unset;max-width:unset;background:transparent;border:1px dashed var(--border)}

    .view-container{flex:1;overflow:hidden;position:relative}
    .view{position:absolute;inset:0;display:none;overflow:auto}
    .view.active{display:block}

    .dashboard{padding:var(--s4);display:grid;gap:var(--s4);grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:var(--r3);padding:var(--s4);transition:var(--transition)}
    .card:hover{border-color:var(--accent);transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--s3)}
    .card-title{font-weight:700;color:var(--fg-0);font-size:var(--fs4)}
    .card-stats{font-size:var(--fs5);font-weight:800;color:var(--accent)}
    .card-content{color:var(--fg-1);font-size:var(--fs2);line-height:1.6}

    .tape-browser{display:flex;flex-direction:column;height:100%}
    .tape-toolbar{padding:var(--s4);background:var(--bg-1);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:var(--s3)}
    .tape-grid{flex:1;padding:var(--s4);display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:var(--s4);overflow-y:auto}
    .tape-item{background:var(--panel);border:1px solid var(--border);border-radius:var(--r3);padding:var(--s4);transition:var(--transition);cursor:pointer;display:flex;flex-direction:column;gap:var(--s2)}
    .tape-item:hover{border-color:var(--accent);transform:translateY(-2px)}
    .tape-icon{width:48px;height:48px;border-radius:var(--r2);background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--bg-0);margin-bottom:var(--s2)}
    .tape-title{font-weight:800;color:var(--fg-0);font-size:var(--fs3)}
    .tape-meta{color:var(--fg-1);font-size:var(--fs1);display:flex;justify-content:space-between}
    .tape-tags{display:flex;flex-wrap:wrap;gap:4px;margin-top:var(--s2)}
    .tag{background:var(--accent-soft);color:var(--accent);padding:2px 6px;border-radius:10px;font-size:var(--fs0);font-weight:700}

    .editor-container{display:flex;flex-direction:column;height:100%}
    .editor-toolbar{padding:var(--s3);background:var(--bg-1);border-bottom:1px solid var(--border);display:flex;gap:var(--s2);flex-wrap:wrap;align-items:center}
    .editor{background:var(--bg-0);border:none;outline:none;padding:var(--s4);font-family:var(--mono);font-size:var(--fs2);line-height:1.5;color:var(--fg-0);resize:none;overflow:auto;width:100%;height:100%}

    .status-bar{
      background:var(--bg-1);border-top:1px solid var(--border);
      padding:4px var(--s3);font-size:var(--fs1);color:var(--fg-1);
      display:flex;justify-content:space-between;align-items:center;height:24px;
    }
    .badge{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:12px;font-size:var(--fs0);font-weight:800;border:1px solid}
    .badge-success{background:rgba(0,217,166,.1);border-color:var(--success);color:var(--success)}
    .badge-primary{background:var(--accent-soft);border-color:var(--accent);color:var(--accent)}

    /* Canvas Views */
    .canvas-wrap{height:100%;display:grid;grid-template-rows:auto 1fr}
    .canvas-toolbar{padding:var(--s3);background:var(--bg-1);border-bottom:1px solid var(--border);display:flex;gap:var(--s2);align-items:center}
    .canvas-area{position:relative;height:100%;overflow:hidden}
    canvas.atomic-canvas{width:100%;height:100%;display:block;background:radial-gradient(1200px 800px at 30% 20%, rgba(22,242,170,.08), transparent 60%), linear-gradient(180deg, rgba(255,255,255,.02), transparent)}
  </style>
</head>

<body>
  <div class="browser-container">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="logo" title="BLACK CODE BROWSER">
        <!-- Restored SVG Vector -->
        <svg class="logo-svg" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="var(--accent)"/>
              <stop offset="1" stop-color="var(--accent2)"/>
            </linearGradient>
          </defs>
          <rect x="6" y="6" width="52" height="52" rx="12" fill="rgba(255,255,255,.03)" stroke="rgba(255,255,255,.14)"/>
          <path d="M32 14 L46 32 L32 50 L18 32 Z" fill="url(#g)" opacity=".95"/>
          <path d="M32 20 L40 32 L32 44 L24 32 Z" fill="rgba(0,0,0,.35)"/>
          <circle cx="32" cy="32" r="3.2" fill="var(--bg-0)" stroke="rgba(255,255,255,.22)"/>
        </svg>
        <span>BLACK CODE BROWSER</span>
      </div>

      <div class="search-container">
        <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path>
        </svg>
        <input id="searchInput" class="search-bar" placeholder="Search tapes, content, or enter API URL..." />
        <div class="search-actions">
          <button class="btn btn-icon btn-sm" id="searchButton" title="Search">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path>
            </svg>
          </button>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn btn-icon" id="sidebarToggle" title="Toggle Sidebar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <button class="btn btn-icon" id="newTapeBtn" title="New Tape">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"></path>
          </svg>
        </button>
        <button class="btn btn-icon" id="settingsBtn" title="Settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Main -->
    <div class="main-content">
      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <span>Navigation</span>
          <button class="btn btn-sm" id="collapseSidebar">¬´</button>
        </div>

        <div class="nav-list">
          <a href="#" class="nav-item active" data-view="dashboard"><span>üìä</span><span>Dashboard</span></a>
          <a href="#" class="nav-item" data-view="tapes"><span>üìº</span><span>Tape Browser</span><span class="badge badge-primary" id="tapeCount">0</span></a>
          <a href="#" class="nav-item" data-view="editor"><span>‚úèÔ∏è</span><span>Code Editor</span></a>
          <a href="#" class="nav-item" data-view="canvas"><span>üßø</span><span>Canvas</span></a>
          <a href="#" class="nav-item" data-view="api"><span>üîå</span><span>API Explorer</span></a>
          <a href="#" class="nav-item" data-view="database"><span>üíæ</span><span>MX2DB</span></a>
          <a href="#" class="nav-item" data-view="compression"><span>‚ö°</span><span>SCXQ2 Tools</span></a>
          <a href="#" class="nav-item" data-view="forum"><span>üí¨</span><span>Community</span></a>
        </div>

        <div style="padding:16px;border-top:1px solid var(--border-soft)">
          <div style="font-size:12px;color:var(--fg-2)">Storage: <span id="storageUsed">0MB</span>/<span id="storageTotal">100MB</span></div>
          <div style="width:100%;height:8px;border-radius:999px;background:var(--bg-2);margin-top:8px;overflow:hidden">
            <div id="storageBar" style="height:100%;width:0%;background:var(--accent)"></div>
          </div>
        </div>
      </div>

      <!-- Content -->
      <div class="content-area">
        <!-- Tabs -->
        <div class="tab-bar" id="tabBar">
          <div class="tab active" data-tab="dashboard"><div class="tab-favicon"></div><span>Dashboard</span><button class="tab-close">√ó</button></div>
          <div class="tab" data-tab="tapes"><div class="tab-favicon"></div><span>Tapes</span><button class="tab-close">√ó</button></div>
          <div class="tab" data-tab="editor"><div class="tab-favicon"></div><span>Editor</span><button class="tab-close">√ó</button></div>
          <div class="tab" data-tab="canvas"><div class="tab-favicon"></div><span>Canvas</span><button class="tab-close">√ó</button></div>
          <div class="tab" data-tab="api"><div class="tab-favicon"></div><span>API</span><button class="tab-close">√ó</button></div>
          <button class="tab new-tab" id="newTabBtn" title="New Tab">+</button>
        </div>

        <!-- Views -->
        <div class="view-container" id="viewContainer">
          <!-- Dashboard -->
          <div class="view dashboard active" id="view-dashboard">
            <div class="card"><div class="card-header"><div class="card-title">Tape Storage</div><div class="card-stats" id="totalTapes">0</div></div><div class="card-content">Total compressed tape files in MX2DB storage</div></div>
            <div class="card"><div class="card-header"><div class="card-title">API Connections</div><div class="card-stats" id="apiConnections">0</div></div><div class="card-content">Active API endpoints and data sources</div></div>
            <div class="card"><div class="card-header"><div class="card-title">Compression Ratio</div><div class="card-stats" id="compressionRatio">0%</div></div><div class="card-content">Average SCXQ2 compression efficiency</div></div>
            <div class="card"><div class="card-header"><div class="card-title">Recent Activity</div><div class="card-stats" id="recentActivity">0</div></div><div class="card-content">Last 24 hours of tape operations</div></div>
            <div class="card"><div class="card-header"><div class="card-title">Community Posts</div><div class="card-stats" id="communityPosts">0</div></div><div class="card-content">Active discussions in integrated forums</div></div>
            <div class="card"><div class="card-header"><div class="card-title">System Health</div><div class="badge badge-success" id="systemStatus">OK</div></div><div class="card-content">All systems operational</div></div>
          </div>

          <!-- Tapes -->
          <div class="view tape-browser" id="view-tapes">
            <div class="tape-toolbar">
              <div style="display:flex;gap:8px;align-items:center">
                <button class="btn btn-primary" id="uploadTapeBtn">Upload Tape</button>
                <button class="btn" id="refreshTapesBtn">Refresh</button>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <select class="btn" id="tapeFilter" style="padding:8px 10px">
                  <option value="all">All</option><option value="json">JSON</option><option value="xml">XML</option><option value="html">HTML</option>
                  <option value="css">CSS</option><option value="javascript">JavaScript</option><option value="compressed">Compressed</option>
                </select>
                <input class="search-bar" id="tapeSearch" placeholder="Search tapes..." style="border-radius:12px;padding:8px 12px;max-width:260px"/>
              </div>
            </div>
            <div class="tape-grid" id="tapeGrid"></div>
          </div>

          <!-- Editor -->
          <div class="view editor-container" id="view-editor">
            <div class="editor-toolbar">
              <button class="btn" id="saveEditorBtn">üíæ Save</button>
              <button class="btn" id="formatEditorBtn">‚ú® Format</button>
              <button class="btn" id="compressEditorBtn">‚ö° Compress</button>
              <button class="btn" id="decompressEditorBtn">üîì Decompress</button>
              <button class="btn" id="editorToCanvasBtn">üßø Canvas Preview</button>
              <div style="flex:1"></div>
              <select class="btn" id="editorLanguage" style="padding:8px 10px">
                <option value="html">HTML</option><option value="css">CSS</option><option value="javascript">JavaScript</option>
                <option value="json">JSON</option><option value="xml">XML</option><option value="markdown">Markdown</option>
              </select>
            </div>
            <textarea class="editor" id="codeEditor" placeholder="Start typing your code here..."></textarea>
          </div>

          <!-- Canvas (Browser + Editor share this view; sw.js can switch modes) -->
          <div class="view" id="view-canvas">
            <div class="canvas-wrap">
              <div class="canvas-toolbar">
                <button class="btn" id="canvasClearBtn">Clear</button>
                <button class="btn" id="canvasGridBtn">Grid</button>
                <button class="btn" id="canvasPlayBtn">Play</button>
                <span style="color:var(--fg-2);font-size:12px">Mesh Canvas (SW-routed)</span>
                <div style="flex:1"></div>
                <button class="btn btn-primary" id="canvasPushBtn">Push Frame ‚Üí Mesh</button>
              </div>
              <div class="canvas-area">
                <canvas id="atomicCanvas" class="atomic-canvas"></canvas>
              </div>
            </div>
          </div>

          <!-- API -->
          <div class="view" id="view-api" style="padding:16px">
            <div class="card">
              <div class="card-header"><div class="card-title">API Explorer</div></div>
              <div class="card-content">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
                  <div class="card" style="margin:0">
                    <div class="card-header"><div class="card-title">Endpoints</div></div>
                    <div class="card-content" id="apiEndpoints"></div>
                  </div>
                  <div class="card" style="margin:0">
                    <div class="card-header"><div class="card-title">Request</div></div>
                    <div class="card-content">
                      <div style="display:grid;gap:10px">
                        <input class="search-bar" id="apiUrl" placeholder="https://api.example.com/endpoint" style="border-radius:12px;padding:8px 12px"/>
                        <select class="btn" id="apiMethod" style="padding:8px 10px">
                          <option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option><option>PATCH</option>
                        </select>
                        <textarea class="editor" id="apiHeaders" style="height:90px" placeholder="Content-Type: application/json"></textarea>
                        <textarea class="editor" id="apiBody" style="height:140px" placeholder='{"key":"value"}'></textarea>
                        <button class="btn btn-primary" id="sendApiRequest">Send</button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="card" style="margin-top:16px">
                  <div class="card-header"><div class="card-title">Response</div></div>
                  <div class="card-content">
                    <pre id="apiResponse" style="font-family:var(--mono);font-size:13px;max-height:280px;overflow:auto;color:var(--fg-1)">{ "status":"Ready" }</pre>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Placeholder views (kept for routing completeness; SW will render real panels later) -->
          <div class="view" id="view-database" style="padding:16px"><div class="card"><div class="card-header"><div class="card-title">MX2DB</div></div><div class="card-content" id="dbPanel">Loading‚Ä¶</div></div></div>
          <div class="view" id="view-compression" style="padding:16px"><div class="card"><div class="card-header"><div class="card-title">SCXQ2 Tools</div></div><div class="card-content" id="scxPanel">Loading‚Ä¶</div></div></div>
          <div class="view" id="view-forum" style="padding:16px"><div class="card"><div class="card-header"><div class="card-title">Community</div></div><div class="card-content" id="forumPanel">Loading‚Ä¶</div></div></div>
        </div>

        <!-- Status -->
        <div class="status-bar">
          <div id="statusMessage">Booting‚Ä¶</div>
          <div style="display:flex;gap:10px;align-items:center">
            <span id="connectionStatus">üü° SW</span>
            <span id="currentTime">--:--:--</span>
          </div>
        </div>
      </div>
    </div>

    <div id="sidebarOverlay" style="display:none"></div>
  </div>

  <!-- Tiny bootstrap only: everything else lives in sw.js -->
  <script>
    (async () => {
      const set = (id, v) => { const el = document.getElementById(id); if (el) el.textContent = v; };
      try {
        if (!('serviceWorker' in navigator)) throw new Error('ServiceWorker not supported');
        const reg = await navigator.serviceWorker.register('/sw.js', { scope: '/' });
        set('connectionStatus', 'üü¢ SW');
        navigator.serviceWorker.ready.then(() => navigator.serviceWorker.controller?.postMessage({ t:'BOOT' }));
      } catch (e) {
        set('connectionStatus', 'üî¥ NO-SW');
        set('statusMessage', 'SW failed: ' + e.message);
      }
      // clock
      setInterval(() => {
        const d = new Date();
        document.getElementById('currentTime').textContent = d.toLocaleTimeString([], { hour:'2-digit', minute:'2-digit', second:'2-digit' });
      }, 1000);
    })();
  </script>
</body>
</html>
